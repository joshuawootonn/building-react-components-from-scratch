import classNames from 'clsx'
import { memo, ReactNode } from 'react'
import { v4 as uuid } from 'uuid'

import { Folder, File, Arrow } from 'components/treeview/icons'
import { useTreeNode } from 'lib/treeview'
import { TreeNodeType, TreeviewProvider } from 'lib/treeview'

type NodeProps = {
    node: TreeNodeType
    depth?: number
    children?: ReactNode | ReactNode[]
}

export const Node = memo(function TreeNode({ node }: NodeProps) {
    const { isOpen, isFocusable, isSelected, getTreeNodeProps, treeGroupProps, metadata } =
        useTreeNode(node.id)

    return (
        <li
            {...getTreeNodeProps({
                className:
                    'relative cursor-pointer select-none flex flex-col focus:outline-none group',
            })}
        >
            <div
                className={classNames(
                    'group flex flex-row items-center border-[1.5px] border-transparent rounded-[7px] space-x-2',
                    isFocusable && 'group-focus:bg-black/10 focus-within:border-transparent',
                    isSelected ? 'bg-black/20 ' : 'bg-transparent text-black',
                )}
            >
                {metadata.isFolder ? (
                    <Arrow className="h-4 w-4" isExpanded={isOpen} />
                ) : (
                    <span className="h-4 w-4" />
                )}
                {metadata.icon}
                <span className="font-['Source_Sans_Pro'] font-medium text-ellipsis whitespace-nowrap overflow-hidden flex-grow">
                    {metadata.name}
                </span>
            </div>
            {isOpen && node.children && (
                <ul {...treeGroupProps} className="pl-2">
                    {node.children.map(node => (
                        <AppleTreeview.Node node={node} key={node.id} />
                    ))}
                </ul>
            )}
        </li>
    )
})

type RootProps = {
    value: TreeNodeType[]
    label: string
    className?: string
    children?: ReactNode | ReactNode[]
}

export const Root = function TreeRoot({ value, className, children, ...props }: RootProps) {
    return (
        <TreeviewProvider
            {...props}
            className={classNames(
                className,
                "bg-[#F4F5F5] rounded-[10px] p-4 h-full overflow-auto font-['Source_Sans_Pro']  ",
            )}
            value={value}
        >
            <style jsx>{`
                @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600&display=swap');
            `}</style>
            {children}
        </TreeviewProvider>
    )
}

export const AppleTreeview = { Root, Node }

export const initialValue: TreeNodeType[] = [
    {
        id: uuid(),
        name: 'AirDrop',
        icon: (
            <svg
                width="18"
                height="17"
                viewBox="0 0 18 17"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M0.5 8.70801C0.5 11.0405 1.44629 13.1572 2.96533 14.6929C3.07324 14.7925 3.18945 14.7925 3.28076 14.6763L3.6543 14.2612C3.75391 14.145 3.74561 14.0454 3.646 13.9375C2.33447 12.5845 1.5127 10.7334 1.5127 8.70801C1.5127 4.62402 4.89941 1.229 9 1.229C13.1006 1.229 16.4873 4.62402 16.4873 8.70801C16.4873 10.7334 15.6655 12.5845 14.354 13.9375C14.2544 14.0454 14.2461 14.145 14.3457 14.2612L14.7192 14.6763C14.8105 14.7925 14.9268 14.7925 15.0347 14.6846C16.5537 13.1572 17.5 11.0405 17.5 8.70801C17.5 4.05127 13.6899 0.208008 9 0.208008C4.31006 0.208008 0.5 4.05127 0.5 8.70801ZM2.91553 8.70801C2.91553 10.3184 3.53809 11.771 4.56738 12.8667C4.67529 12.9829 4.7915 12.9746 4.89111 12.8667L5.26465 12.4517C5.37256 12.3438 5.35596 12.2441 5.25635 12.1279C4.43457 11.2231 3.93652 10.0278 3.93652 8.70801C3.93652 5.94385 6.21924 3.64453 9 3.64453C11.7808 3.64453 14.0635 5.94385 14.0635 8.70801C14.0635 10.0278 13.5654 11.2231 12.7437 12.1196C12.644 12.2358 12.6274 12.3438 12.7354 12.4434L13.1172 12.8667C13.2085 12.9746 13.333 12.9829 13.4326 12.8667C14.4536 11.771 15.0845 10.3184 15.0845 8.70801C15.0845 5.37109 12.3535 2.62354 9 2.62354C5.64648 2.62354 2.91553 5.37109 2.91553 8.70801ZM5.33105 8.70801C5.33105 9.58789 5.63818 10.3931 6.16943 11.0405C6.26074 11.1484 6.37695 11.1484 6.48486 11.0322L6.875 10.6338C6.97461 10.5259 6.96631 10.418 6.8916 10.3018C6.55127 9.86182 6.35205 9.30566 6.35205 8.70801C6.35205 7.26367 7.55566 6.06006 9 6.06006C10.4443 6.06006 11.6479 7.26367 11.6479 8.70801C11.6479 9.30566 11.4487 9.86182 11.1084 10.3018C11.0254 10.418 11.0171 10.5259 11.125 10.6338L11.5151 11.0405C11.6147 11.1484 11.7393 11.1567 11.8306 11.0322C12.3618 10.3931 12.6689 9.58789 12.6689 8.70801C12.6689 6.69922 11.0171 5.03906 9 5.03906C6.98291 5.03906 5.33105 6.69922 5.33105 8.70801ZM3.62939 16.2451C3.37207 16.519 3.52979 16.9341 3.91992 16.9341H14.0635C14.4536 16.9341 14.6113 16.519 14.3623 16.2451L9.34863 10.5757C9.14941 10.3682 8.83398 10.3682 8.63477 10.5757L3.62939 16.2451Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'joshuawootonn',
        icon: (
            <svg
                width="20"
                height="18"
                viewBox="0 0 20 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M0.0888672 8.54199C0.0888672 8.88232 0.354492 9.20605 0.802734 9.20605C1.03516 9.20605 1.22607 9.08154 1.40039 8.94043L9.70947 1.96777C9.89209 1.80176 10.1162 1.80176 10.2988 1.96777L18.6079 8.94043C18.7739 9.08154 18.9648 9.20605 19.1973 9.20605C19.5874 9.20605 19.9028 8.96533 19.9028 8.56689C19.9028 8.31787 19.8198 8.15186 19.6455 8.00244L17.3213 6.04346V2.72314C17.3213 2.35791 17.0889 2.12549 16.7236 2.12549H15.8354C15.4785 2.12549 15.2378 2.35791 15.2378 2.72314V4.29199L11.0044 0.739258C10.3901 0.216309 9.62646 0.216309 9.00391 0.739258L0.354492 8.00244C0.171875 8.15186 0.0888672 8.35107 0.0888672 8.54199ZM2.67871 15.9546C2.67871 17.1001 3.37598 17.7808 4.54639 17.7808H15.4619C16.6323 17.7808 17.3213 17.1001 17.3213 15.9546V9.37207L10.498 3.65283C10.1826 3.38721 9.80908 3.39551 9.50195 3.65283L2.67871 9.37207V15.9546ZM12.1416 16.4443H7.8584V10.9575C7.8584 10.5757 8.11572 10.3267 8.49756 10.3267H11.5107C11.8926 10.3267 12.1416 10.5757 12.1416 10.9575V16.4443Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'art',
        icon: (
            <svg
                width="20"
                height="22"
                viewBox="0 0 20 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M2.21387 19.8389C3.6001 21.2251 5.21875 21.2417 6.58008 19.8804C7.58447 18.876 8.63867 16.5103 9.41895 15.5806L11.187 17.3569C11.8345 18.0127 12.6147 18.0127 13.2456 17.3818L14.3164 16.3027C14.8228 15.7881 14.9224 15.207 14.6152 14.6592L18.1431 11.1313C19.0645 10.21 19.0479 9.10596 18.1016 8.15967L11.5854 1.63525C10.7139 0.763672 9.20312 1.104 8.896 2.45703C8.22363 5.38721 8.10742 6.05957 7.24414 7.37109C6.74609 7.15527 6.21484 7.27979 5.75 7.73633L4.6792 8.81543C4.04834 9.44629 4.04004 10.2183 4.6958 10.874L6.47217 12.6421C5.55078 13.4224 3.18506 14.4683 2.18066 15.4727C0.819336 16.834 0.827637 18.4609 2.21387 19.8389ZM12.8887 10.3428C13.312 10.7661 15.5781 9.5293 16.4912 8.5L17.0889 9.09766C17.4707 9.47949 17.4707 9.94434 17.1138 10.3013L13.7354 13.688L8.28174 8.23438C9.26123 6.76514 9.43555 5.71924 10.1328 3.146C10.2407 2.72266 10.5894 2.61475 10.8716 2.88867L14.7397 6.74854C14.5405 8.12646 13.8018 9.13916 12.9136 10.0273C12.8057 10.1353 12.814 10.2681 12.8887 10.3428ZM5.83301 9.5542L6.50537 8.89844C6.72119 8.68262 6.95361 8.67432 7.16943 8.89014L13.1709 14.8833C13.3784 15.0991 13.3784 15.3315 13.1543 15.5557L12.5068 16.2114C12.291 16.4438 12.042 16.4521 11.8262 16.2197L9.84229 14.2275C9.53516 13.9204 9.13672 13.9536 8.78809 14.2939C8.14062 14.9331 7.00342 17.6641 5.68359 18.9756C4.88672 19.7808 3.92383 19.7808 3.09375 18.959C2.28027 18.1372 2.27197 17.166 3.07715 16.3691C4.39697 15.0576 7.12793 13.9204 7.76709 13.2729C8.09912 12.916 8.14062 12.5176 7.8335 12.2188L5.83301 10.2266C5.61719 10.0107 5.61719 9.77002 5.83301 9.5542ZM4.36377 18.7349C4.92822 18.7349 5.38477 18.27 5.38477 17.7056C5.38477 17.1411 4.92822 16.6846 4.36377 16.6846C3.79932 16.6846 3.33447 17.1411 3.33447 17.7056C3.33447 18.27 3.79932 18.7349 4.36377 18.7349Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [
            {
                id: uuid(),
                name: 'art piece 1',
            },
            {
                id: uuid(),
                name: 'art piece 2',
            },
            {
                id: uuid(),
                name: 'art piece 3',
            },
            {
                id: uuid(),
                name: 'art piece 4',
            },
            {
                id: uuid(),
                name: 'art piece 5',
            },
        ],
    },
    {
        id: uuid(),
        name: 'source',
        icon: (
            <svg
                width="22"
                height="21"
                viewBox="0 0 22 21"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M1.32959 18.5854L2.77393 20.0381C3.50439 20.7769 4.34277 20.7271 5.13135 19.8555L13.7808 10.3262C14.0049 10.4009 14.2373 10.3843 14.5029 10.3345L15.4077 10.1685L15.9722 10.7412L15.939 11.2144C15.9058 11.6377 16.0137 11.9614 16.4287 12.3682L17.0762 12.999C17.4829 13.4058 18.0059 13.4307 18.4043 13.0322L20.8779 10.5503C21.2764 10.1519 21.2598 9.64551 20.853 9.23877L20.1973 8.59131C19.7905 8.18457 19.4751 8.05176 19.0684 8.08496L18.5786 8.12646L18.0308 7.58691L18.2383 6.63232C18.3462 6.15088 18.2134 5.77734 17.7153 5.2793L15.8477 3.41992C13.0088 0.597656 9.24023 0.664062 6.7832 3.12109C6.42627 3.46973 6.40137 3.95947 6.60059 4.2915C6.7998 4.59863 7.18994 4.79785 7.73779 4.65674C8.98291 4.36621 10.2778 4.31641 11.4897 5.11328L10.9917 6.3501C10.8257 6.75684 10.8008 7.09717 10.9087 7.4043L1.50391 16.2363C0.665527 17.0166 0.599121 17.8467 1.32959 18.5854ZM8.05322 3.43652C10.1201 1.92578 12.9175 2.18311 14.8101 4.07568L16.877 6.12598C17.0762 6.3252 17.1094 6.48291 17.0513 6.77344L16.7773 8.03516L18.0557 9.29688L18.894 9.24707C19.1099 9.23877 19.1763 9.25537 19.3423 9.42139L19.832 9.91113L17.7568 11.9863L17.2671 11.4966C17.1011 11.3306 17.0762 11.2642 17.0845 11.04L17.1426 10.21L15.8726 8.94824L14.5776 9.16406C14.3037 9.22217 14.1792 9.19727 13.9717 8.99805L12.27 7.29639C12.0542 7.09717 12.0293 6.95605 12.1621 6.64062L12.9092 4.86426C11.5811 3.62744 9.85449 3.09619 8.12793 3.60254C7.99512 3.63574 7.94531 3.52783 8.05322 3.43652ZM3.39648 18.959L2.40039 17.9712C2.00195 17.5811 2.09326 17.2905 2.43359 16.9834L11.6226 8.33398L12.8677 9.5957L4.37598 18.9341C4.07715 19.2744 3.79492 19.3574 3.39648 18.959Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'Recents',
        icon: (
            <svg
                width="18"
                height="18"
                viewBox="0 0 18 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M9 17.4736C13.6318 17.4736 17.4668 13.6304 17.4668 9.00684C17.4668 4.375 13.6235 0.540039 8.9917 0.540039C4.36816 0.540039 0.533203 4.375 0.533203 9.00684C0.533203 13.6304 4.37646 17.4736 9 17.4736ZM9 16.0625C5.08203 16.0625 1.95264 12.9248 1.95264 9.00684C1.95264 5.08887 5.07373 1.95117 8.9917 1.95117C12.9097 1.95117 16.0474 5.08887 16.0557 9.00684C16.064 12.9248 12.918 16.0625 9 16.0625ZM4.65869 9.90332H8.9917C9.31543 9.90332 9.57275 9.6543 9.57275 9.32227V3.72754C9.57275 3.40381 9.31543 3.15479 8.9917 3.15479C8.66797 3.15479 8.41895 3.40381 8.41895 3.72754V8.74951H4.65869C4.32666 8.74951 4.07764 8.99854 4.07764 9.32227C4.07764 9.6543 4.32666 9.90332 4.65869 9.90332Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'Downloads',
        icon: (
            <svg
                width="18"
                height="18"
                viewBox="0 0 18 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M9 17.4736C13.6318 17.4736 17.4668 13.6304 17.4668 9.00684C17.4668 4.375 13.6235 0.540039 8.9917 0.540039C4.36816 0.540039 0.533203 4.375 0.533203 9.00684C0.533203 13.6304 4.37646 17.4736 9 17.4736ZM9 16.0625C5.08203 16.0625 1.95264 12.9248 1.95264 9.00684C1.95264 5.08887 5.07373 1.95117 8.9917 1.95117C12.9097 1.95117 16.0474 5.08887 16.0557 9.00684C16.064 12.9248 12.918 16.0625 9 16.0625ZM9 4.78174C8.64307 4.78174 8.37744 5.03906 8.37744 5.4043V9.55469L8.44385 11.3062L7.61377 10.3101L6.62598 9.31396C6.50977 9.20605 6.36035 9.13135 6.18604 9.13135C5.8457 9.13135 5.58838 9.39697 5.58838 9.729C5.58838 9.90332 5.63818 10.0527 5.74609 10.1606L8.51855 12.9248C8.68457 13.0908 8.82568 13.1572 9 13.1572C9.18262 13.1572 9.33203 13.0825 9.48975 12.9248L12.2539 10.1606C12.3618 10.0527 12.4282 9.90332 12.4282 9.729C12.4282 9.39697 12.1626 9.13135 11.8223 9.13135C11.6396 9.13135 11.4902 9.19775 11.3823 9.31396L10.4028 10.3101L9.55615 11.3145L9.62256 9.55469V5.4043C9.62256 5.03906 9.36523 4.78174 9 4.78174Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'Pictures',
        icon: (
            <svg
                width="22"
                height="18"
                viewBox="0 0 22 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M2.84863 13.8711H4.43408V15.1411C4.43408 16.8511 5.29736 17.7144 7.04053 17.7144H19.1514C20.8779 17.7144 21.7495 16.8511 21.7495 15.1411V6.74072C21.7495 5.03076 20.8779 4.16748 19.1514 4.16748H17.5576V2.89746C17.5576 1.1875 16.686 0.324219 14.9595 0.324219H2.84863C1.10547 0.324219 0.242188 1.1875 0.242188 2.89746V11.2979C0.242188 13.0078 1.10547 13.8711 2.84863 13.8711ZM2.86523 12.5347C2.03516 12.5347 1.57861 12.0864 1.57861 11.2231V2.97217C1.57861 2.10889 2.03516 1.66064 2.86523 1.66064H14.9346C15.7563 1.66064 16.2212 2.10889 16.2212 2.97217V4.16748H7.04053C5.29736 4.16748 4.43408 5.02246 4.43408 6.74072V12.5347H2.86523ZM5.77051 6.81543C5.77051 5.95215 6.22705 5.50391 7.05713 5.50391H19.1265C19.9482 5.50391 20.4131 5.95215 20.4131 6.81543V13.4229L17.4082 10.5757C17.0513 10.2437 16.6113 10.0776 16.1714 10.0776C15.7231 10.0776 15.3164 10.2354 14.9429 10.5674L11.2573 13.8379L9.77979 12.5098C9.43945 12.2026 9.06592 12.0366 8.67578 12.0366C8.31055 12.0366 7.97021 12.1943 7.62158 12.5015L5.77051 14.1035V6.81543ZM9.9209 10.7832C10.9751 10.7832 11.8467 9.91162 11.8467 8.84082C11.8467 7.78662 10.9751 6.90674 9.9209 6.90674C8.8501 6.90674 7.97852 7.78662 7.97852 8.84082C7.97852 9.91162 8.8501 10.7832 9.9209 10.7832Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
    {
        id: uuid(),
        name: 'Applications',
        icon: (
            <svg
                width="18"
                height="18"
                viewBox="0 0 18 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M14.3086 6.62842C15.8774 6.62842 17.1807 5.3252 17.1807 3.74805C17.1807 2.1709 15.8774 0.867676 14.3086 0.867676C12.7231 0.867676 11.4282 2.1709 11.4282 3.74805C11.4282 5.3252 12.7231 6.62842 14.3086 6.62842ZM0.34668 13.2109C0.34668 14.6304 0.471191 15.8091 1.31787 16.6558C2.16455 17.5024 3.35986 17.6353 4.771 17.6353H11.2207C12.6401 17.6353 13.8354 17.5024 14.6821 16.6558C15.5288 15.8091 15.6533 14.6304 15.6533 13.2109V7.55811C15.2881 7.68262 14.8896 7.74902 14.4746 7.73242C14.4165 7.74902 14.375 7.74902 14.3169 7.75732V13.4351C14.3169 14.2983 14.209 15.1782 13.7026 15.6846C13.2046 16.1826 12.3081 16.2988 11.4531 16.2988H4.54688C3.69189 16.2988 2.79541 16.1826 2.28906 15.6846C1.79102 15.1782 1.68311 14.2983 1.68311 13.4351V6.62012C1.68311 5.74854 1.79102 4.85205 2.28906 4.354C2.79541 3.84766 3.7002 3.73975 4.57178 3.73975H10.2993C10.2993 3.68164 10.3076 3.63184 10.3159 3.58203C10.2993 3.16699 10.3657 2.76855 10.4902 2.40332H4.75439C3.35986 2.40332 2.16455 2.53613 1.31787 3.38281C0.471191 4.22949 0.34668 5.4165 0.34668 6.80273V13.2109Z"
                    fill="#007AFF"
                />
            </svg>
        ),
        children: [],
    },
]
